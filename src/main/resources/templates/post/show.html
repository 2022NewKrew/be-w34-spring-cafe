<!DOCTYPE html>
<html lang="kr">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>kakao Java Web Programming</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="/css/reset.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="/css/index.css" rel="stylesheet">
    <link href="/css/post/show.css" rel="stylesheet">
</head>
<body>
    <div class="background">
        <nav class="navbar navbar-fixed-top header">
            <div class="col-md-12">
                <div class="navbar-header">
                    <a href="/" class="navbar-brand">
                        <img src="/images/KakaoCI.png" />
                    </a>

                </div>
                <ul class="nav navbar-nav navbar-right">
                    <li class="active"><a href="/users/list">멤버 리스트</a></li>
                    {{^signInUser}}
                    <li><a class="black-component" href="/users/sign-in" role="button">로그인</a></li>
                    <li><a class="black-component" href="/users/sign-up" role="button">회원가입</a></li>
                    {{/signInUser}}
                    {{#signInUser}}
                    <li class="login-active"><a href="/users/profile/{{userId}}">{{name}} ({{email}}) 님</a></li>
                    <li>
                        <form id="logout" method="post" action="/users/sign-out">
                            <a class="black-component" href="javascript:;" onclick="document.getElementById('logout').submit()" role="button">로그아웃</a>
                        </form>
                    </li>
                    {{/signInUser}}
                </ul>
            </div>
        </nav>
        {{^signInUser}}
        <p class="user-title">게시글 보기 권한이 없습니다.</p>
        {{/signInUser}}
        {{#signInUser}}
        <div class="container" id="main">
            <div class="content-container col-md-12 col-sm-12 col-lg-12">
                <div class="panel panel-default">
                    {{^postVo}}
                    <p class="user-title">게시글 정보가 없습니다.</p>
                    {{/postVo}}
                    {{#postVo}}
                    {{#post}}
                    <header class="post-header"><p class="post-title">{{title}}</p></header>
                    <div class="content-main">
                        <article class="article">
                            <div class="article-header">
                                <div class="article-header-text">
                                    <p class="article-content">{{userId}}</p>
                                    <p class="article-content">작성일자:{{createdAt}}</p>
                                    <p class="article-content">조회 {{view}}</p>
                                </div>
                            </div>
                            <div class="article-doc">
                                <pre>{{content}}</pre>
                            </div>
                        </article>

                        <div class="post-comment">
                            <div class="post-comment-slipp">
                                <div class="post-comment-count">
                                    <p>댓글 {{replyCnt}}개</p>
                                    {{#canEdit}}
                                    <script>
                                        function deletePost(e) { return confirm("정말 삭제할까요?") }
                                    </script>
                                    <form class="post-action-box" method="post" action="/posts/delete/{{postId}}" onsubmit="return deletePost(this)">
                                        <a class="post-edit-btn" href="/posts/edit/{{postId}}" class="btn btn-primary pull-right" role="button">게시글 수정</a>
                                        <input type="hidden" name="_method" value="DELETE">
                                        <button class="post-edit-btn" class="btn btn-primary pull-right" role="button">게시글 삭제</button>
                                    </form>
                                    {{/canEdit}}
                                </div>

                                <div class="post-comment-slipp-articles">
                                    {{#replies}}
                                    <article class="comment">
                                        {{#reply}}
                                        <div class="article-text">
                                            <p class="comment-content comment-author-name">{{userId}}</p>
                                            <div class="comment-content comment-doc">
                                                <pre>{{content}}</pre>
                                            </div>
                                            <div class="reply-footer">
                                                <p class="comment-content comment-time">{{createdAt}}</p>
                                                {{#canDelete}}
                                                <script>
                                                    const checkRemoveRely = () => confirm("덧글을 지울까요?")
                                                </script>
                                                <form method="post" action="/replies/{{postId}}/{{replyId}}" onsubmit="return checkRemoveRely()">
                                                    <input type="hidden" name="_method" value="DELETE">
                                                    <button class="black-component"><p>덧글 삭제</p></button>
                                                </form>
                                                {{/canDelete}}
                                            </div>
                                        </div>
                                        {{/reply}}

                                    </article>
                                    {{/replies}}

                                    <script>
                                        const submitRely = () => {
                                            if(document.getElementById("reply-content").value) return true;
                                            alert("덧글 내용이 비어있습니다.")
                                            return false
                                        }
                                    </script>
                                    <form class="submit-write" method="post" action="/replies/{{postId}}" onsubmit="return submitRely()">
                                        <div class="comment-writer-container">
                                            <div class="comment-writer" id="writer" name="writer"/>{{signInUser.userId}}</div>
                                        </div>
                                        <div class="form-group">
                                            <textarea class="form-control" id="reply-content" name="content" placeholder="내용을 입력하세요"></textarea>
                                        </div>
                                        <input class="post-write-btn" type="submit" value="등록"/>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    {{/post}}
                    {{/postVo}}
                </div>
            </div>
        </div>
        {{/signInUser}}
    </div>
	</body>
</html>
